var searchForm=document.querySelector(".search"),searchInput=searchForm.querySelector("[name=search]"),mapLink=document.querySelector(".map"),mapPopup=document.querySelector(".modal-map"),mapClose=mapPopup.querySelector(".modal-close"),link=document.querySelector(".write-to-us-link"),popup=document.querySelector(".write-to-us"),close=document.querySelector(".write-to-us-modal-close"),form=popup.querySelector(".write-to-us-form"),modalName=popup.querySelector(".write-to-us-name"),modalEmail=popup.querySelector(".write-to-us-email"),modalMessage=popup.querySelector(".write-to-us-message"),isStorageSupport=!0,isStorageEmail=!0,storage="",emailStorage="";searchForm.addEventListener("submit",function(e){searchInput.value||e.preventDefault()}),mapLink.addEventListener("click",function(e){e.preventDefault(),mapPopup.classList.remove("visually-hidden"),mapPopup.classList.add("modal-show")}),mapClose.addEventListener("click",function(e){e.preventDefault(),mapPopup.classList.add("visually-hidden"),mapPopup.classList.remove("modal-show")}),window.addEventListener("keydown",function(e){27===e.keyCode&&(mapPopup.classList.contains("visually-hidden")||(e.preventDefault(),mapPopup.classList.add("visually-hidden"),mapPopup.classList.remove("modal-show")))});try{storage=localStorage.getItem("name")}catch(e){isStorageSupport=!1}try{emailStorage=localStorage.getItem("email")}catch(e){isStorageEmail=!1}link.addEventListener("click",function(e){e.preventDefault(),popup.classList.add("modal-show"),popup.classList.remove("visually-hidden"),storage&&emailStorage?(modalName.value=storage,modalEmail.value=emailStorage,modalMessage.focus()):modalName.focus()}),close.addEventListener("click",function(e){e.preventDefault(),popup.classList.remove("modal-show"),popup.classList.add("visually-hidden"),popup.classList.remove("modal-error")}),form.addEventListener("submit",function(e){modalName.value&&modalEmail.value&&modalMessage.value?isStorageSupport&&isStorageEmail&&(localStorage.setItem("name",modalName.value),localStorage.setItem("email",modalEmail.value)):(e.preventDefault(),popup.classList.remove("modal-error"),popup.offsetWidth=popup.offsetWidth,popup.classList.add("modal-error"),modalName.value?modalName.removeAttribute("required"):(console.log("Enter name"),modalName.setAttribute("required","")),modalEmail.value?modalEmail.removeAttribute("required"):(console.log("Enter email"),modalEmail.setAttribute("required","")),modalMessage.value?modalMessage.removeAttribute("required"):(console.log("Enter message"),modalMessage.setAttribute("required","")))}),window.addEventListener("keydown",function(e){27===e.keyCode&&(popup.classList.contains("modal-show")||(e.preventDefault(),popup.classList.add("visually-hidden"),popup.classList.remove("modal-show"),popup.classList.remove("modal-error")))});
